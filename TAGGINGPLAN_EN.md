# Tagging plan for SDK Android #


## Webview app tracking

About the navigation in a *webview* type of app on Android (html/js standard website), our internal ID must be provided once the URL opens in order to guarantee the tracking.
To retrieve this value, the technical support of the client must use the following function in our SDK:

  * Android:
```xml
String euidl = EAnalytics.getEUIDL();
```

Once the value is in the parameter **ea-euidl-bypass**, the cookies system is modified in order to use the euidl from the app.

**Example:**

```xml
http://www.vpg.fr/ios-landing-webview?ea-euidl-bypass=$euidl_de_l_app
```

If the ea.js detects a parameter, it will automatically use it and store it during the entire session in order to stop the website from sending it again every time the user visits the page.\\
Once this parameter is passed, the tracking of an IOS app in a webview context is the same as for a classic website.

The documentation available [here](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:general) contains all the information to implement our tags in the JavaScript.



## Native app tracking

In the case of a native app, our SDK must be added to the code of the app in order to integrate the following marker:

```xml
EAProperties properties = new EAProperties.Builder("NOM_PAGE”).build();
Eanalytics.getInstance().track(properties);
```

Our **SDK** has been designed to help its integration by offering an easy structure and a detailed documentation.

The parameters and possibilities are the exact same as for our tag collector. Therefore, you will be able to follow the different navigation routes and to compare them to your classic website, integrating the same variables.

The calls generated by these tags are very similar to the calls generated by the classic collectors, and they have been conceived to be as light as possible so they do not disturb the functioning of the app.

Some parameters of our collector are specific to a mobile app tracking. To know more about this, you can check [this documentation](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

Also, our SDK is able to gather an unlimited number of offline interactions and to send them when the user is online.  This process allows us to keep tracking of the user even if they are using the app offline. The navigation is registered and reassigned a posteriori through the parameter ereplay-time.

## Traffic assignation rule

In a classic website, out system identifies and assigns the traffic according to the calling **URL**. However, in the case of an app we do not have access to this information.

Therefore, to define the traffic attribution rule, we will take into account the tracking subdomain used and passed as a parameter **init** on the Eulerian Analytics page:

```xml
public class YourApp extends Application {
     @Override
    public void onCreate() {
        super.onCreate();
        EAnalytics.init(this, "DOMAINE_DE_TRACKING", true);
    }
 }
```

Note: This also means that if you use the same tracking subdomain for several apps, they will have to be differentiated by adding the parameter [from](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list) in the markers. This will happen automatically in a hybrid app which shares some pages with your website.

It is also important to know that the absence of a URL means also the absence of the name page by default. The parameter [path](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list) is not optional but __obligatory__ for the tracking of an app.

The traffic generated by your app can be tracked and checked in Eulerian’s website, or be combined with the traffic from a different website. As shown before, if your app changed to webview mode, it will be obligatory for some pages to add the parameter [from](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list) so the traffic is properly redirected to our system. 

## Downloads and updates 

Associated parameters: 
  * **ea-appname**: NOM_APPLICATION , it is the name of the app. It must not change
  * **ea-appversion**: VERSION_APPLICATION, it is the version of the app
  * **ea-appinstalled**: 1, it must be added to all users who have downloaded the app before the update of the calling URL containing the two parameters above 

The presence of the parameter **ea-appname** triggers a treatment of the system. 

The system will feed the metric **download** if:
  * The user has never been exposed to the value of the parameter **ea-appname** upon launching the app and the parameter **ea-appinstalled** is not present in the call

The system will feed the metric **update** if:
  * The user has already been exposed to the parameter **ea-appname** and its value is identical to the parameter in the last launch of the app. However, the value of the parameter **ea-appversion** is different.

![download_upgrade.png](https://bitbucket.org/repo/kA6LdM/images/3930826066-download_upgrade.png)

## Integration through jCenter 

For mobile applications, **jCenter** allows you to simplify the integration of the SDK.

### Installation

Insert the Android SDK in the tool [Gradle](http://gradle.org/|Gradle).
```xml
dependencies {
   compile 'com.eulerian.android.sdk:eanalytics:1.6.0'
}
```

You must allow the following permissions in the file **AndroidManifest.xml**:

```javascript
<uses-permission android:name="android.permission.INTERNET" />
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
```

Also, add the following wording to the element of the app in order to track the referrer’s installation.

```javascript
<receiver
   android:name="com.eulerian.android.sdk.InstallReferrerReceiver"
   android:exported="true">
   <intent-filter>
      <action android:name="com.android.vending.INSTALL_REFERRER" />
   </intent-filter>
</receiver>
```

## Start Eulerian Analytics

Before using the SDK, make sure you start it through the function **onCreate()** as shown below.

```javascript
<!-- in your AndroidManifest.xml-->
<application
   android:name=".DemoApp">
```

```javascript
public class DemoApp extends Application {

    @Override
    public void onCreate() {
        super.onCreate();
        EAnalytics.init(this, "example.demo.com", false);
    }

}
```

Now you will be able to integrate any type of tag and parameter. For example, the generic tag is identified through EAProperties. The other types of tags have specific identification (for example, EACart for the cart, EAEstimate for the budget, EAProducts for the category, etc.).

```javascript
EASearch search = new EASearch.Builder("/path-example", "banana")
                .setParams(new Params.Builder()
                        .addParam("provenance", "martinique")
                        .addParam("couleur", "jaune")
                        .build())
                .setResults(42)
                .build();

EAnalytics.getInstance().track(search)
```

# List of pages #

  * Generic page
  * Product page
  * Category page
  * Search engine page
  * Error page
  * Cost estimate page
  * Cart page
  * Order page

# Generic page

The marker below is generic and must be implemented in every page of the site except the product sheet, order, cost estimate and initiated cart ones. This includes particularly the homepage and the pages of the conversion tunnel between the cart and the order confirmation.

It allows you to include all the site-centric traffic, the viewed pages and the visits, as well as the origin through natural channels such as direct access, natural indexing or referents.

We manage all the actions to be implemented. Like this, you do not need to change de code of your site to benefit from supplementary functionalities.

You may add the parameters below to the generic format or to the collector markers described in this documentation in order to get more interesting reports.

### List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

### Implementation

The object **EAProperties** is the category containing all the internal or modifiable parameters of our Tag collector. 

To add a new parameter, use one of the native methods **setCLE(VALEUR)** or one of the generic methods **set("CLE","VALEUR")**.

__**Example:**__


```xml
EAProperties genericTag = new EAProperties.Builder("NOM_PAGE")
.setUID("UID")
.set("NOM_PARAM_PERSO","VALEUR_PARAM_PERSO")
.build();
Eanalytics.getInstance().track(genericTag);
```

__**With values:**__

```xml
EAProperties genericTag = new EAProperties.Builder("|univers|rubrique|page")
.setUID("5434742")
.set("abonnement","mensuel")
.build();
Eanalytics.getInstance().track(genericTag);
```

# Product page

This marker allows you to retrieve the viewed pages and the visits to the products in the catalog. It feeds the reports available in the following address:

  * Site-centric > Products > **Product Acquisitions & Performance**

You can also pass one or several product categories.

**Note: Every marker containing only one product reference without the parameters __scart__ __estimate__ __ref__ and __amount__ will be considered a product page.**
In plain language, a collector marker containing one of the parameters above or several product references will not be considered by our system as a marker of a product page.

## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdref:**__ (ID_PRODUIT) This parameter must be fulfilled with the references of the product checked by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdname:**__ (NOM_PRODUIT) You can give a product reference a more legible name to make your reports easier. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdgroup:**__ (GROUPE) You may associate a group to a product reference. This parameter allows you to associate a margin to a product via an association to a group names “A” or “B”. Every label names a margin group without sharing the exact amount in our Tag collector. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdparam-xxxxx:**__ (NOM_PARAM, VALEUR_PARAM) This parameter allows you to associate a category to a product reference. You must precise the name of the category after the prefix **prdparam-**. Examples: prdparam-universe, prdparam-size, etc. You can add as many categories as you want. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

The object **EAProducts** is the category dedicated to the tracking of product pages.

The product must be created via the object **Product** which takes its reference in the obligatory parameters.
Every object **Product** may be completed with an object **Params** to associate one or more parameters to it.
Once the product has been started and completed with the desired parameters, you must integrate the object **EAProducts** via the method **addProduct**.

__**Example:**__

```xml
Params param1 = new Params.Builder()
.addParam("NOM_PARAM","VALEUR_PARAM")
.addParam("marque", "MARQUE")
.addParam("categorie", "CATEGORIE")
.build();

Product produit1 = new Product.Builder("ID_PRODUIT")
.setName("NOM_PRODUIT")
.setGroup("GROUPE")
.setParams(param1)
.build();

EAProducts productPage = new EAProducts.Builder("NOM_PAGE")
.setUID("UID")                
.addProduct(produit1)
.build();

EAnalytics.getInstance().track(productPage);
```

__**With values:**__

```xml
Params param1 = new Params.Builder()
.addParam("univers", "Vetement")
.addParam("categorie", "Tshirt")
.build();

Product produit1 = new Product.Builder("G73624623")
.setName("Tshirt_bleu")
.setGroup("A")
.setParams(param1)
.build();

EAProducts productPage = new EAProducts.Builder("Vetements|Tshirts|Tshirt_bleu_marqueA")
.setUID("63726")
.set("newsletter", "oui")
.addProduct(produit1)
.build();

EAnalytics.getInstance().track(productPage);
```

# Result page

This marker allows you to send your partners the first 3 product references in the results page to optimize the retargeting of users in your site.

Its use is limited to our product Eulerian Tag Master, and it does not affect the acquisition&performance report in Eulerian’s DDP.

**Note: Every marker containing several product references without the parameters __scart__ __estimate__ __ref__ and __amount__ will be considered a result page.** 

In case your results page only contains one product reference and therefore only the parameter **prdref**, the market will be considered as a product page and not a result page.

## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdref:**__ (ID_PRODUIT) This parameter must be fulfilled with the references of the product checked by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

Use the object **EAProducts** for this type of Tag and pass the first X shown products.

The product itself must be created via the object **Product** which takes its reference in the obligatory parameters. 
Once this is completed with the desired parameters, you must integrate it to the object **EAProducts** via the method addProduct. 

__**Example:**__

```xml
Product produit1 = new Product.Builder("ID_PRODUIT_1").build();
Product produit2 = new Product.Builder("ID_PRODUIT_2").build();
Product produit3 = new Product.Builder("ID_PRODUIT_3").build();
 
EAProducts resultPage = new EAProducts.Builder("NOM_PAGE")
.setUID("UID")                
.addProduct(produit1)
.addProduct(produit2)
.addProduct(produit3)
.build();
 
EAnalytics.getInstance().track(resultPage);
```

__**With values:**__

```xml
Product produit1 = new Product.Builder("CH32452").build();
Product produit2 = new Product.Builder("C654322").build();
Product produit3 = new Product.Builder("V643536").build();
 
EAProducts resultPage = new EAProducts.Builder("Categorie|Vestes")
.setUID("73646")                
.addProduct(produit1)
.addProduct(produit2)
.addProduct(produit3)
.build();
 
EAnalytics.getInstance().track(resultPage);
```

# Internal search page

This marker allows you to include in your interface queries made by users as well as an unlimited number of additional parameters. All the information is compared to the sales and the acquisition channels activated during the session.

**Note: Every marker containing the parameter __isearchengine__ will be considered a search engine page.**

The marker of the search engine is not exclusive. If you add a product reference with the parameter **prdref** for instance, the marker will be considered a product page.

## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**isearchengine:**__ (NOM_MOTEUR) This parameter will name the internal search engine and allows you to differentiate it from other search fields, in case you have more than one in your site. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**isearchresults:**__ (NOMBRE_DE_RESULTATS) This parameter must contain the number of search results generated by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**isearchkey:**__ (CLE_DU_PARAMETRE_DE_RECHERCHE) This parameter must contain the key of the additional fields you want to integrate in your internal search marker. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**isearchdata:**__ (VALEUR_DU_PARAMETRE_RECHERCHE) This parameter must contain the value of the isearchkey field named above. Every supplementary search field requires we add the parameters isearchkey and isearchdata. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

The object **EASearch** is the category dedicated to the tracking of the internal search engine.

Create an object**Params** and use the method **addParam** for every **isearchkey** and **isearchdata** parameter.

__**Examples:**__

```xml
Params param1 = new Params()
.addParam("CLE_DU_PARAMETRE_DE_RECHERCHE_1","VALEUR_DU_PARAMETRE_RECHERCHE_1")
.addParam("CLE_DU_PARAMETRE_DE_RECHERCHE_2","VALEUR_DU_PARAMETRE_RECHERCHE_2")
.addParam("CLE_DU_PARAMETRE_DE_RECHERCHE_3","VALEUR_DU_PARAMETRE_RECHERCHE_3")
.build();

EASearch searchPage = new EASearch.Builder("NOM_PAGE", "NOM_MOTEUR")
.setUID("UID")
.setResults(NOMBRE_DE_RESULTATS)
.setParams(param1)
.build();

EAnalytics.getInstance().track(searchPage);
```

__**With values:**__

```xml
Params param1 = new Params()
.addParam("motcle","veste")
.addParam("montant_min","100.00")
.addParam("montant_max","400.00")
.build();

EASearch searchPage = new EASearch.Builder("Moteur_interne|veste", "moteur_interne")
.setUID("34678")
.setResults(150)
.setParams(Params)
.build();

EAnalytics.getInstance().track(searchPage);
```

# 404 error page

The **error** marker indicated that the application has generated a 404 error. It feeds your reports, available in the following address:

  * Site-centric > Audience analysis > Per page > **Error page**

This tag allows you to retrieve all the URL which generated a 404 page and allow you to make the necessary corrections to redirect the traffic.

You may use it to be notified in case of recurring problems in a particular step of your conversion tunnel.

## List of parameters

  * __**error:**__ This parameter is always **1** and can be added to all types of markers. Its presence in the marker will count up one viewed page in the report previously mentioned. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**path:**__ (NOM_DE_LA_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

Use the method **set** with the key **__error__** to flag the error page.

__**Example:**__

```xml
EAProperties errorTag = new EAProperties.Builder("erreur|404")
.set("error","1")
.build();
Eanalytics.getInstance().track(errorTag);
```

# Cost estimate page

This marker count up the cost estimates and the information related to this type of conversion: 
  * The products in it. 
  * The type of estimate.
  * The total sum
  * Contextual information 

Every new estimate is provided with the details of all the channels and the navigation history that led to its generation. 

**Note: Duplicates will be removed according to the references provided by the marker.**


If you use twice the same reference for the same two estimates, the second call will be ignored in virtue of the principle of uniqueness conversion.\\
Eulerian’s DDP allows you to cancel or validate estimates to measure the real performance of your campaigns in time. 

**Note: Every marker containing the parameters __ref__ and __estimate__ will be considered a cost estimate page.**

## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**ref:**__ (REFERENCE_DU_DEVIS) This is a unique reference of the estimate allowing you to identify it and find it in our system. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**amount:**__ (MONTANT_DU_DEVIS) This parameter must contain the total sum with taxes. Decimals will be separated by a point. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**type:**__ (TYPE_DE_DEVIS) This parameter allows you categorize the cost estimate according to you reference document. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdref:**__ (ID_PRODUIT) This parameter must be fulfilled with the references of the product checked by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdamount:**__ (MONTANT_PRODUIT) This parameter allows you to specify the total of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdquantity:**__ (QUANTITE_PRODUIT) This parameter allows you to specify the quantity of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

The object **EAEstimate** is the category dedicated to the tracking of cost estimation pages.

An estimation can contain one or several products. Every product must be created via the object **Product** which takes its reference in the obligatory parameters.
Every object **Product** must be completed with the desired parameters before being integrated in the object **EAEstimate** via the method addProduct. 

__**Example:**__

```xml
Product produit1 = new Product.Builder("ID_PRODUIT_1").build();
Product produit2 = new Product.Builder("ID_PRODUIT_2").build();

EAEstimate estimatePage = new EAEstimate.Builder("NOM_PAGE", "REFERENCE_DU_DEVIS")
.setAmount(MONTANT_DU_DEVIS)
.setType("TYPE_DE_DEVIS")
.setUID("UID")          
.addProduct(produit1, MONTANT_PRODUIT_1, QUANTITE_PRODUIT_1)
.addProduct(produit2, MONTANT_PRODUIT_2, QUANTITE_PRODUIT_2)
.build();
 
EAnalytics.getInstance().track(estimatePage);
```

__**With values:**__

```xml
Product produit1 = new Product.Builder("505").build();

EAEstimate estimatePage = new EAEstimate.Builder("Credit|devis", "C4536567")
.setAmount(5000.00)
.setType("Credit_48mois")
.setUID("627253")          
.addProduct(produit1, 5000.00, 1)
.build();
 
EAnalytics.getInstance().track(estimatePage);
```

# Cart page

This marker counts up the initiated carts and allows you to calculate the conversion and quitting rate in relation to the sale marker.

You may also move products and categories associated to the visitor’s cart by specifying the respective sums and quantities. These parameters allow you to feed your product reports available in the following address:

  * Site-centric > Products > **Product Acquisitions & Performance**

The cart lifespan is 30 minutes, according to [[fr:glossary|our definition]].

**Note: Every marker containing the parameter __scart__ will be considered a cart page.**


## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**scartcumul:**__ (0_OU_1) The value of this parameter shows the way to count up the products in the cart. When it equals 0, our system considers the products passed by the marker as part of the cart. When it equals 1, le products passed by the marker will be added to every successive call. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdref:**__ (ID_PRODUIT) This parameter must be fulfilled with the references of the product checked by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdamount:**__ (MONTANT_PRODUIT) This parameter allows you to specify the total of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdquantity:**__ (QUANTITE_PRODUIT) This parameter allows you to specify the quantity of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

The object **EACart** is the category dedicated to the tracking of the initiated cart pages.

A cart can contain one or several products. Every product must be created via the object **Product** which takes its reference in the obligatory parameters.
Every object **Product** must be completed with the desired parameters before being integrated in the object **EACart** via the method **addProduct**. 

__**Example:**__

```xml
Product produit1 = new Product.Builder("ID_PRODUIT_1").build();
Product produit2 = new Product.Builder("ID_PRODUIT_2").build();
Product produit3 = new Product.Builder("ID_PRODUIT_3").build();
 
EACart cartPage = new EACart.Builder("NOM_PAGE")
.setCartCumul(true_OU_false)
.setUID("UID")
.addProduct(produit1, MONTANT_PRODUIT_1, QUANTITE_PRODUIT_1)
.addProduct(produit2, MONTANT_PRODUIT_2, QUANTITE_PRODUIT_2)
.addProduct(produit3, MONTANT_PRODUIT_3, QUANTITE_PRODUIT_3)
.build();
 
EAnalytics.getInstance().track(cartPage);
```

__**With values:**__

```xml
Product produit1 = new Product.Builder("XY65643").build();
Product produit2 = new Product.Builder("XV12345").build();
 
EACart cartPage = new EACart.Builder("Panier")
.setCartCumul(false)
.setUID("57483")
.addProduct(produit1, 65.00, 1)
.addProduct(produit2, 20.00, 3)
.build();
 
EAnalytics.getInstance().track(cartPage);
```

# Order page

This marker counts up the conversions and helps estimating the ROI for all your marketing channels. In addition to the total sum of the order, you can include the products, the type of payment, the currency and the type of sale. These priorities enrich the detail level of your reportings and may be exploited in our product. Every new conversion includes all details about the channels and the navigation history. 

**Note: Duplicates will be removed according to the references provided by the marker.**


If you use twice the same reference for the same two estimates, the second call will be ignored in virtue of the principle of unique order.

Eulerian Analytics allows you to cancel orders to measure the real performance of your campaigns. We recommend you to implement the order tag as soon as possible in the buying process if the information to set the call is available (reference, sum, type of payment, etc.).

In fact, if the payment platform does not require the user goes back to the site to validate their order, a market after the payment platform will not always be called.

**Note: Beside the order status (pending, valid or invalid), it is not possible to define the content of an order after it is registered. We cannot add or delete a product, but we can modify the total sum of the order.**

**Note: Every marker containing the parameters __ref__ and __amount__ and not containing the parameters __scart__ and __estimate__ will be considered a confirmation page.**


## List of parameters

  * __**path:**__ (NOM_PAGE) This parameter allows you to name the page in order to identify it in the reports. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**uid:**__ (UID) This parameter must be fulfilled with your internal ID when the user is logged in in order to consolidate the history data gathered from different devices. You may also reconcile a click with the download of the app. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**ref:**__ (REFERENCE_DE_LA_VENTE) This is a unique reference of the estimate allowing you to identify it and find it in our system. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**amount:**__ (MONTANT_DE_LA_VENTE) This parameter must contain the total sum with taxes. Decimals will be separated by a point. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**payment:**__ (MOYEN_DE_PAIEMENT) This parameter allows you to include the type of payment used by the buyer. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**type:**__ (TYPE_DE_VENTE) This parameter allows you categorize the cost estimate according to you reference document. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**currency:**__ (DEVISE_DU_MONTANT) This parameter allows you to convert the total indicated in the parameter amount if it is in a different currency than the one used in the interface. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**profile:**__ (profile) Usually, you can force the profile of a user in any type of page. This parameter is often used in the order tag to differentiate new buyers and loyal customers. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdref:**__ (ID_PRODUIT) This parameter must be fulfilled with the references of the product checked by the user. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdamount:**__ (MONTANT_PRODUIT) This parameter allows you to specify the total of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).
  * __**prdquantity:**__ (QUANTITE_PRODUIT) This parameter allows you to specify the quantity of each product in the cost estimate. To know more about this you may check [this article](https://eulerian.wiki/doku.php?id=en:collect:technical_implementation:parameters_list).

## Implementation

The object **EAOrder** is the category dedicated to the tracking of orders.

An order tag can contain one or several products. Every product must be created via the object **Product** which takes its reference in the obligatory parameters.
Every object **Product** must be completed with the desired parameters before being integrated in the object **EAOrder** via the method **addProduct**

__**Example:**__

```xml
Product produit1 = new Product.Builder("ID_PRODUIT_1").build();
Product produit2 = new Product.Builder("ID_PRODUIT_2").build();
Product produit3 = new Product.Builder("ID_PRODUIT_3").build();
 
EAOrder orderPage = new EAOrder.Builder("NOM_PAGE", "REFERENCE_DE_LA_VENTE")
.setAmount(MONTANT_DE_LA_VENTE)
.setType("TYPE_DE_VENTE")
.setPayment("MOYEN_DE_PAIEMENT")
.setCurrency("DEVISE_DU_MONTANT")
.setEstimateRef("REFERENCE_DU_DEVIS_ASSOCIE")
.setUID("UID")
.set("profile", "NOUVEAU_OU_ANCIEN_CLIENT")
.addProduct(produit1, MONTANT_PRODUIT_1, QUANTITE_PRODUIT_1)
.addProduct(produit2, MONTANT_PRODUIT_2, QUANTITE_PRODUIT_2)
.addProduct(produit3, MONTANT_PRODUIT_3, QUANTITE_PRODUIT_3)
.build();
 
EAnalytics.getInstance().track(orderPage);
```

__**With values:**__

```xml
Product produit1 = new Product.Builder("HA1432245").build();
Product produit2 = new Product.Builder("VE98373626").build();
 
EAOrder orderPage = new EAOrder.Builder("Tunnel|Confirmation", "F654335671")
.setAmount(460.00)
.setType("Vol+Hotel")
.setPayment("CB")
.setCurrency("USD")
.setEstimateRef("D872635671")
.setUID("62524")
.set("profile", "nouveau_client")
.addProduct(produit1, 60.00, 1)
.addProduct(produit2, 400.00, 1)
.build();
 
EAnalytics.getInstance().track(orderPage);
```
